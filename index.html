<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>Финасовый калькулятор</title>
	<meta name="author" content="Дмитрий Жиляев">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<link rel="stylesheet" href="css/bootstrap.min.css">
	<!-- Favicon -->
	<link rel="apple-touch-icon" sizes="180x180" href="favicon/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="favicon/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="favicon/favicon-16x16.png">
	<link rel="manifest" href="favicon/manifest.json">
	<link rel="mask-icon" href="favicon/safari-pinned-tab.svg" color="#5bbad5">
	<meta name="theme-color" content="#ffffff">
	<style>
		.title {
			text-align: center;
			display: flex;
			flex-direction: row;
			justify-content: center;
		}

		.title:before,
		.title:after {
			flex-grow: 1;
			height: 1px;
			content: '\a0';
			background-color: #ddd;
			position: relative;
			top: 0.5em;
		}

		.title:before {
			margin-right:10px;
		}

		.title:after {
			margin-left:10px;
		}
	</style>
</head>
<body>
<br>
<section id="app">
<header class="container">
	<div class="form-row">
		<nav class="nav nav-tabs col">
			<!-- VUE RENDER MENU -->
			<a class="nav-item nav-link" v-for="(n, index) in goals.asArrayOfObj()" @click="setActive(index)" :class="{'active':index==i}"  href="#">
				<b>{{n.name}}</b> #<i>{{index+1}}</i>
				<button v-if="goals.length!=1" type="button" class="close" @click="delTab()" aria-label="Close">
					<span aria-hidden="true">&times;</span>
				</button>
			</a>
			<!-- / VUE RENDER MENU -->
			<a class="nav-item nav-link text-success" id="creator" href="#" @click="newTab()">
				<img src="svg/si-glyph-folder-plus.svg" width="24">
				<b>Новая цель</b>
			</a>
		</nav>
		<div class="col-">
			<a href="#" class="btn-primary btn btn-block"  data-toggle="modal" data-target="#modal">
				<img src="svg/si-glyph-button-arrow-down.svg" width="26">
				<b>PDF</b>
			</a>
		</div>
	</div>
</header>
<section class="container">
	<div class="card">
		<div class="card-header">
			<h1>
				<img src="svg/si-glyph-square-star.svg" width="48">
				&nbsp;{{current.name}} #{{i+1}} <wbr><small class="float-lg-right text-nowrap" title="Требуемая доходность инвестиций" data-placement="bottom"><img src="svg/si-glyph-air-balloon.svg" width="48"> &nbsp;<i>{{resultPercent.toFixed(4)}}</i><img width="32" src="svg/si-glyph-percent.svg"> </small>
			</h1>
		</div>
		<div class="card-body">
			<fieldset>
				<div class="form-row">
					<div class="col-sm">
						<label for="prior"><b>#</b></label>
						<label for="name" style="margin-left: 80px;">Название:</label>
						<div class="input-group">
							<div class="input-group-btn">
								<select class="form-control custom-select" id="prior" title="Приоритет">
									<!-- Max prior = count of goals -->
									<option v-for="n in goals.length" :value="n-1" :selected="n==i+1">{{n}}</option>
								</select>
							</div>
							<label class="input-group-addon" for="name"><img src="svg/si-glyph-square-star.svg" width="16"></label>
							<input class="form-control" value="Цель" id="name" v-model="current.name" placeholder="На Яхту">
						</div>
					</div>

					<div class="col-sm">
						<label for="dream" title="Необходимая сумма для достижения цели"><img src="svg/si-glyph-piggy-bank.svg" width="26">Конечная сумма <img src="svg/si-glyph-circle-info.svg" width="16"></label>
						<div class="input-group">
							<div class="input-group-btn">
								<select class="form-control custom-select" id="cy" v-model="current.cy" title="Выберите валюту">
									<option>₽</option>
									<option>$</option>
									<option>€</option>
								</select>
							</div>
							<input class="form-control" min="0" type="number" v-model.number="current.dream" id="dream" placeholder="10000">
						</div>
					</div>
				</div>
				<div class="form-row">
					<div class="col-sm">
						<label for="dateStart" title="Дата в которую будет открыт счет">Срок от <img src="svg/si-glyph-circle-info.svg" width="16"></label>
						<div class="input-group">
							<label class="input-group-addon" for="dateStart"><img src="svg/si-glyph-calendar-1.svg" width="16"></label>
							<input class="form-control" type="date" v-model="current.dateStart" id="dateStart">
						</div>
					</div>

					<div class="col-sm">
						<label for="dateFinish" title="Дата в которую будет закрыт счет">Срок до <img src="svg/si-glyph-circle-info.svg" width="16"></label>
						<div class="input-group">
							<label class="input-group-addon" for="dateFinish"><img src="svg/si-glyph-calendar-1.svg" width="16"></label>
							<input class="form-control" type="date" v-model="current.dateFinish" id="dateFinish">
						</div>
					</div>

					<div class="col">
						<label> Срок вклада (в  месяцах): </label>
						<p>
							= <b> {{current.diffMonths = Date.diff(new Date(current.dateStart), new Date(current.dateFinish))[1]}}</b>
						</p>
					</div>
				</div>
			</fieldset>
			<br>
			<fieldset>
				<legend align="center"><img src="svg/si-glyph-calendar-1.svg" width="64"></legend>
				<legend><h2 class="title">Расчет</h2></legend>
				<br>
				<form>
					<!-- ROW 1 -->
					<div class="form-row">
						<div class="col-sm">
							<label for="inCom"><img src="svg/si-glyph-chart-column-increase.svg" width="26"> Доход/месяц</label>
							<div class="input-group">
								<span class="input-group-addon">{{current.cy}}</span>
								<input class="form-control" min="0" type="number" v-model.number="current.inCom" placeholder="60000" id="inCom">
							</div>
						</div>

						<div class="col">
							<label for="expense"><img src="svg/si-glyph-chart-column-decrease.svg" width="26"> Расход/месяц</label>
							<div class="input-group">
								<span class="input-group-addon">{{current.cy}}</span>
								<input class="form-control" min="0" type="number" v-model.number="current.expense" placeholder="30000" id="expense">
							</div>
						</div>

						<div class="col">
							<label title="Ежемесячные сбережения">Выручка:</label>
							<p>
								= <b>&nbsp;{{current.cy}} {{current.gain =current.inCom - current.expense}} </b>
							</p>
						</div>
					</div>
					<!-- / ROW 1 -->
					<!-- ROW 2 Percent -->
					<div class="form-row">
						<div class="col-md">
							<label for="brokerPercent" title="Какой процент ежемесячных сбережений вы будете отправлять на брокерский счет">
								На Брокерский счет
								<img src="svg/si-glyph-circle-info.svg" width="16">
							</label>
							<div class="input-group">
								<label class="input-group-addon"><img src="svg/si-glyph-percent.svg" width="16"></label>
								<input class="form-control" v-model="current.brokerPercent" min="0" max="100" type="number" id="brokerPercent" placeholder="70">
								<span class="input-group-addon" id="broker">{{current.broker = current.gain * current.brokerPercent/100}}</span>
							</div>
						</div>

						<div class="col-sm">
							<label for="pillowPercent" title="в финансовую подушку">Подушка <img src="svg/si-glyph-circle-info.svg" width="16"></label>
							<div class="input-group">
								<span class="input-group-addon"><img src="svg/si-glyph-percent.svg" width="16"></span>
								<input class="form-control" min="0" max="100" type="number" v-model="current.pillowPercent" id="pillowPercent" placeholder="20">
								<span class="input-group-addon" id="pillow">{{current.pillow = current.gain * current.pillowPercent/100}}</span>
							</div>
						</div>

						<div class="col-sm">
							<label for="reservePercent" title="в резервный фонд">Резерв <img src="svg/si-glyph-circle-info.svg" width="16"></label>
							<div class="input-group">
								<span class="input-group-addon"><img src="svg/si-glyph-percent.svg" width="16"></span>
								<input class="form-control" min="0" max="100" type="number" v-model="current.reservePercent" id="reservePercent" placeholder="10">
								<span class="input-group-addon" id="reserve">{{current.reserve = current.gain * current.reservePercent/100}}</span>
							</div>
						</div>
					</div>
					<!-- / ROW 2 Percent -->
					<!-- ROW 3 RightNow -->
					<div class="form-row">
						<div class="col-md">
							<label for="rightNow" title="Сколько денег вы готовы прямо сейчас инвестировать на брокерский счет?">
								Сколько денег прямо сейчас?
								<img src="svg/si-glyph-circle-info.svg" width="16">
							</label>
							<div class="input-group">
								<span class="input-group-addon">{{current.cy}}</span>
								<input class="form-control" min="0" type="number" v-model.number="current.rightNow"  id="rightNow" placeholder="20000">
							</div>
						</div>

						<div class="col">
							<label for="pillowRightNow" title="в финансовую подушку прямо сейчас">Подушка <img src="svg/si-glyph-circle-info.svg" width="16"></label>
							<div class="input-group">
								<span class="input-group-addon">{{current.cy}}</span>
								<input class="form-control" min="0" type="number" v-model.number="current.pillowRightNow" placeholder="20000"  id="pillowRightNow">
							</div>
						</div>

						<div class="col">
							<label for="reserveRightNow" title="в резервный фонд прямо сейчас">Резерв <img src="svg/si-glyph-circle-info.svg" width="16"></label>
							<div class="input-group">
								<span class="input-group-addon">{{current.cy}}</span>
								<input class="form-control" min="0" type="number" v-model.number="current.reserveRightNow" placeholder="20000"  id="reserveRightNow">
							</div>
						</div>
					</div>
					<!-- / ROW 3 RightNow -->
					<br>
					<div class="form-row">
						<div class="col">
							<button class="btn btn-lg btn-outline-info btn-block" type="reset">
								<img src="svg/si-glyph-arrow-circle-rycycle.svg" width="24">
								Очистить форму
							</button>
						</div>
						<div class="col">
							<button class="btn btn-lg btn-secondary btn-block" type="reset" onclick="if(confirm('Осторожно! Это удалит все данные (потребуется время)')){localStorage.clear(); location.reload();}">
								<img src="svg/si-glyph-trash.svg" width="24">
								Сбросить цели
							</button>
						</div>
					</div>
				</form>
			</fieldset>
		</div>
	</div>
</section>
	<!-- MODAL -->
	<div class="modal fade" id="modal">
		<div class="modal-dialog modal-lg" role="document">
			<div class="modal-content">
				<div class="modal-header">
					<h2 class="modal-title"><img src="svg/si-glyph-chart-decrease.svg" width="48"> Личный финасовый план</h2>
					<button type="button" class="close" data-dismiss="modal" aria-label="Close">
						<span aria-hidden="true">&times;</span>
					</button>
				</div>
				<div class="modal-body">
					<table id="tablePDF" class="table table-inverse text-center">
						<thead>
						<tr>
							<th id="tableDate" nowrap>Дата</th>
							<th id="tableTotalMoney">Все деньги</th>
							<th id="tableBroker">На брокерском счете</th>
							<th id="tablePillow">В подушке</th>
							<th id="tableReserve">В резерве</th>
							<th id="tableChecked">Статус</th>
						</tr>
						</thead>
						<tbody>
						<tr v-for="(n, index) in goals.calcTable()">
							<td headers="tableDate">{{n.date.ddmmyyyy('.')}}</td>
							<td headers="tableTotalMoney">{{n.totalMoney}}</td>
							<td headers="tableBroker">{{n.broker}}</td>
							<td headers="tablePillow">{{n.pillow}}</td>
							<td headers="tableReserve">{{n.reserve}}</td>
							<td headers="tableChecked" :class="{'bg-success':n.checked}">{{n.checked}}</td>
						</tr>
						</tbody>
					</table>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-outline-primary btn-lg btn-block" onclick="genPDF()">
						<img src="svg/si-glyph-document-pdf.svg" width="35">
						Скачать личный финасовый план.pdf
					</button>
				</div>
			</div>
		</div>
	</div>
	<!-- / MODAL -->
</section>
<br>
<footer class="container">
	<div class="row">
		<div class="col-lg justify-content-lg-center">
			<div class="align-content-lg-center" align="center">
				<img src="svg/si-glyph-code.svg" align="center" width="120">
			</div>
			<h5 align="center">© 2017. All rights reserved</h5>
			<div class="align-content-lg-center" align="center">
				<iframe src="https://ghbtns.com/github-btn.html?user=zhilyaev&type=follow&size=large" frameborder="0" scrolling="0" width="177px" height="30px"></iframe>
				<iframe src="https://ghbtns.com/github-btn.html?user=zhilyaev&repo=FinHelper&type=star&size=large" frameborder="0" scrolling="0" width="75px" height="30px"></iframe>
				<iframe src="https://ghbtns.com/github-btn.html?user=vonvee&type=follow&size=large" frameborder="0" scrolling="0" width="177px" height="30px"></iframe>
			</div>
		</div>
	</div>
</footer>
<script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
<script src="https://unpkg.com/popper.js"></script>
<script src="https://unpkg.com/tooltip.js"></script>
<!-- Don`t forget make min.js -->
<script src="libs/bootstrap.min.js"></script>
<script src="libs/jspdf.debug.js"></script>
<script src="libs/vue.js"></script>
<script src="js/date.js"></script>
<script src="js/calc.js"></script>
<script src="js/pdf.js"></script>
<script>
    $(function () {
        // Делаем красивый title
        $('[title]').tooltip();
    })
</script>
</body>
</html>
